generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = "postgresql://postgres:pasword@localhost:5432/cado4ok?schema=public"
}

model School {
  id       String  @id @default(uuid())
  name     String
  address  String
  email    String  @unique
  admins   User[]  @relation("Admins")
  teachers User[]  @relation("Teachers")
  parents  User[]  @relation("Parents")
  groups   Group[]
}

model Group {
  id       String @id @default(uuid())
  name     String
  school   School @relation(fields: [schoolId], references: [id])
  schoolId String
  teachers User[]
}

enum Role {
  ADMIN
  TEACHER
  PARENT
}

model User {
  id                String  @id @default(uuid())
  firstName         String
  lastName          String
  email             String  @unique
  phone             String  @unique
  role              Role    @default(PARENT)
  kids              Kid[]
  note              String?
  adminOfSchool     School? @relation("Admins", fields: [adminOfSchoolId], references: [id])
  adminOfSchoolId   String?
  teacherOfSchool   School? @relation("Teachers", fields: [teacherOfSchoolId], references: [id])
  teacherOfSchoolId String?
  parentOfSchool    School? @relation("Parents", fields: [parentOfSchoolId], references: [id])
  parentOfSchoolId  String?
  groupTeacher      Group?  @relation(fields: [groupId], references: [id])
  groupId           String?
}

model Kid {
  id            String       @id @default(uuid())
  name          String
  parentNote    String?
  hasDailyLunch Boolean      @default(false)
  parent        User?        @relation(fields: [parentId], references: [id])
  parentId      String
  ExcuseList    ExcuseList[]
  AddedList     AddedList[]
}

model ExcuseList {
  id    String   @id @default(uuid())
  date  DateTime
  kid   Kid      @relation(fields: [kidId], references: [id])
  kidId String
  note  String?
}

model AddedList {
  id    String   @id @default(uuid())
  date  DateTime
  kid   Kid      @relation(fields: [kidId], references: [id])
  kidId String
  note  String?
}

model DayStats {
  date       DateTime @unique
  addedIds   Int[]
  absentIds  Int[]
  lunchCount Int
}
